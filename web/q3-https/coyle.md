### HTTP의 동작을 설명하세요



### HTTP란 ? 

HTTP + SSL(Secure Socket Layer) = HTTPS (HTTP Secure)

HTTPS는 SSL이라는 보안 프로토콜 위에서 동작하는 HTTP



그럼 SSL은 보안 소켓 계층을 이르는 것으로, 인터넷 상에서 데이터를 안전하게 전송하기 위한 인터넷 암호화 통신 프로토콜이다.



하나의 예로 우리가 HTTP의 패킷을 분석하면 POST로 보낸 데이터는 평문 텍스트를 그대로 노출한다. 암호화되지 않은 데이터를 전송하기 때문에 서버와 클라이언트가 주고받는 메시지를 그대로 노출하여 보안에 아주 취약하다.



> SSL을 표준화한 것이 TLS(Transfer Layer Sercurity, = SSL 3.0) 이다. 



### 그럼 어떻게 동작하나요 ?

응용계층의 HTTP 프로토콜에서 사용자의 데이터를 받고 전송계층으로 캡슐화되기 이전에 SSL 프로토콜에 의해서 사용자의 데이터가 암호화된다. 그리고 서버는 전송계층에서 세그먼트를 받아 SSL 계층에서 데이터를 복호화하여 응용계층까지 보낸다.



#### 대칭키 암호화 방식

- 인코딩과 디코딩에 같은 키를 사용하는 알고리즘
- 단점 : 단점은 발송자와 수신자가 서로 대화하려면 둘 다 공유키를 가져야 한다는 것이다.
- 대칭키를 전달하는 과정에서 키가 유출이 되면 암호의 내용을 복호화할 수 있기 때문에 위험하다
- 이를 보완하기 위해서 나온 방법이 공개키 암호화 방식이다.

#### 공개키 암호화 방식

- 인코딩과 디코딩에 다른 키를 사용하는 알고리즘
- A키로 암호화를 하면 B키로 복호화를 할 수 있고, B키로 암호화 하면 A키로 복호화 할 수 있는 방식
- 인코딩 키 (public key)는 공개되어 있으며 (그래서 공개키 암호방식이라는 이름이 붙었다.) 보통 디지털 인증서안에 포함되어 있다.
- 디코딩 키는 (secret key)는 호스트만이 개인 디코딩 키를 알고있다.
- 공개키와 비공개키의 분리는 메시지의 인코딩은 누구나 할 수 있도록 해주는 동시에, 메시지의 디코딩은 비밀키 소유자에게만 부여한다.
- 단점 : 공개키 암호화 방식의 알고리즘은 계산이 느린 경향이 있다.



### 디지털 서명

![views](https://i.imgur.com/NWmUEzb.png)

- 전자 서명을 통해서 누가 메시지를 썼는지 알려주고, 메시지가 위조되지 않았음을 증명할 수 있다. 전자서명은 **SSL 인증서** 에서 서비스를 보증하는 방법으로 활용된다.
- 공개키와 비공개키는 안전한 데이터 전달 이외에도, **데이터 제공자의 신원을 보장** 하는데 사용할 수 있다.
- 비공개키의 소유자가 비공개 키를 이용해서 정보를 암호화 => 공개키와 함께 암호화된 정보를 전송 => 수신자는 공개키로 암호화된 정보를 복호화
- 암호화된 데이터를 공개키를 가지고 복호화 할 수 있다는 것은 그 데이터가 공개키와 쌍을 이루는 비공개키에 의해서 암호화 되었다는 것을 의미한다.
- 즉 공개키가 데이터를 제공한 사람의 신원을 보장해주게 되는 것이다. 이러한 것을 전자 서명이라고 부른다.

### SSL 동작방법

- 공개키 암호 방식은 알고리즘 계산방식이 느린 경향이 있다.
- 따라서 SSL은 암호화된 데이터를 전송하기 위해서 공개키와 대칭키 암호화 방식을 혼합하여 사용한다.
- 안전한 의사소통 채널을 수립할 때는 공개키 암호를 사용하고, 이렇게 만들어진 안전한 채널을 통해서 임시의 무작위 대칭키를 생성 및 교환한다. 해당 대칭키는 나머지 데이터 암호화에 활용한다.
  - 실제 데이터 암호화 방식 : 대칭키
  - 상기 대칭키를 서로 공유하기 위한 암호화 방식 : 공개키



### SSL 통신과정

- 컴퓨터와 컴퓨터가 네트워크를 통해서 통신을 할때 `핸드쉐이크 -> 세션 -> 세션종료` 의 과정을 거친다.
- 암호화된 HTTP 메시지를 교환하기 전에 클라이언트와 서버는 `SSL 핸드쉐이크를` 진행한다.
- 핸드쉐이크의 목적은 아래와 같다.
  - 프로토콜 버전번호 교환
  - 양쪽이 알고 있는 pre master secret 키 생성 및 교환
  - 양쪽의 신원 인증
  - 채널을 암호화 하기 위한 임시 세션 키 생성
- SSL 통신과정을 간단하게 도식화 하면 아래와 같다.

![views](https://i.imgur.com/YIfy1wK.png)



- https://opentutorials.org/course/228/4894
