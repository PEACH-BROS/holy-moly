# AOP에 대하여

## 어쩌다가 AOP(I Think...)

'해당 기능을 실행하면서 얼마만큼의 시간이 소요되었는지 출력하세요' 와 같은 기능을 여러 메서드에 구현을 해야한다면 동일한 코드가 여러 메서드에 구현되어야 한다.

단순히 코드의 중복만이 문제가 아니다.

한 가지의 일만 해야 하는 메서드에게 소요된 시간을 측정해야하는 추가적인 기능이 부여된다. 이는 단일 책임 원칙에도 영향을 미친다.

시간 소요를 측정하는 코드가 여러 메서드에 중복되어 존재하면서 메서드의 책임을 증가시키는 상황을 해결하는 방법으로는 상속을 통해서 해결할 수도 있다.

`AbstractPerformance` 와 같은 추상 클래스를 만들고 시간을 측정하는 코드를 구현한 후 내부에 들어갈 코드를 상속받는 클래스에서 구현하게 해서 문제를 해결할 수도 있을 것이다.

그러나 상속은 부모 클래스에 너무나 종속적이기 때문에 그리 좋은 방법이 아니다.

중복되는 코드를 객체지향적인 관점이 아니라 새로운 관점으로 바라보고 해결하는 방법으로, 중복된 코드를 특정한 곳에 모아둔 뒤 해당 코드를 필요한 메서드들이 가져다 쓰는 방식(?)이 AOP이다.



## AOP : Aspect Oriented Programming

관점 지향 프로그래밍. 즉 어떤 로직을 기준으로 핵심적인 관점, 부가적인 관점으로 나누어서 보고 그 관점을 기준으로 각각 모듈화하겠다는 것이다.

여기서 모듈화란 어떤 공통된 로직이나 기능을 하나의 단위로 묶는 것을 말한다.

핵심적인 관점은 우리가 적용하고자 하는 핵심 비즈니스 로직이 되고 부가적인 관점은 핵심 로직을 실행하기 위해서 행해지는 DB 연결, 로깅, 파일 입출력 등을 예로 들 수 있다.

부가적인 관점은 반복적으로 등장하는 코드라고 생각할 수 있고, 이를 Crosscutting Concerns라 부른다.

이처럼 흩어진 concern들을 aspect로 모듈화하고 핵심적인 비즈니스 로직에서 분리하여 재사용하겠다는 것이 AOP의 취지이다.



### AOP 용어

#### 타겟(Target)

- 핵심 기능을 담고 있는 모듈로 타겟은 부가기능을 부여할 대상이 된다.

#### 어드바이스(Advice)

- 어드바이스는 타겟에 제공할 부가기능을 담고 있는 모듈이다.

#### 조인포인트(Join Point)

- 어드바이스가 적용될 수 있는 위치를 말한다.

- 타겟 객체가 구현한 인터페이스의 모든 메서드는 조인 포인트가 된다.

#### 포인트 컷(Pointcut)

- 어드바이스를 적용할 타겟의 메서드를 선별하는 정규표현식이다.

- 포인트컷 표현식은 execution으로 시작하고 메서드의 Signature를 비교하는 방법을 주로 이용한다.

#### 애스펙트(Aspect)

- 애스펙트는 AOP의 기본 모듈이다.

- 애스펙트 = 어드바이스 + 포인트컷

- 애스펙트는 싱글톤 형태의 객체로 존재한다.

#### 어드바이저(Advisor)

- 어드바이저 = 어드바이스 + 포인트컷

- 어드바이저는 Spring AOP에서만 사용되는 특별한 용어이다.

#### 위빙(Weaving)

- 위빙은 포인트컷에 의해서 결정된 타겟의 조인 포인트에 부가기능(어드바이스)를 삽입하는 과정을 뜻한다.

- 위빙은 AOP가 핵심기능(타겟)의 코드에 영향을 주지 않으면서 필요한 부가기능(어드바이스)를 추가할 수 있도록

해주는 핵심적인 처리과정이다.



### Advice 종류

#### Around 어드바이스

타겟의 메서드가 호출되기 이전(before) 시점과 이후 (after) 시점에 모두 처리해야 할 필요가 잇는

부가기능을 정의한다.

- Joinpoint 앞과 뒤에서 실행되는 Advice

#### Before 어드바이스

타겟의 메서드가 실행되기 이전(before) 시점에 처리해야 할 필요가 있는 부가기능을 정의한다.

- Jointpoint 앞에서 실행되는 Advice

#### After 어드바이스

타겟의 메서드가 실행된 이후(after) 시점에 처리해야 할 필요가 있는 부가기능을 정의한다.

- Jointpoint 뒤에서 실행되는 Advice

#### After Returning 어드바이스

타겟의 메서드가 정상적으로 실행된 이후(after) 시점에 처리해야 할 필요가 있는 부가기능을 정의한다.

- Jointpoint 메서드 호출이 정상적으로 종료된 뒤에 실행되는 Advice

#### After Throwing 어드바이스

타겟의 메서드가 예외를 발생된 이후(after) 시점에 처리해야 할 필요가 있는 부가기능을 정의한다.

- 예외가 던져 질때 실행되는 Advice