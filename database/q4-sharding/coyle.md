# 샤딩? 



**데이터베이스 샤딩**(Database Sharding)이란 하나의 거대한 데이터베이스 테이블을 수평 분할하여 여러 개의 작은 단위로 나눈 후, 물리적으로 다른 위치에 분산하여 저장·관리하는 기술이다. 

수평 분할된 1개의 작은 테이블을 샤드(Shard)라고 하는데, 이 샤드를 여러 분산 서버에 분산시킨다.

> 수평 분할(Horizontal Partitioning)
스키마(schema)가 같은 데이터를 두 개 이상의 테이블에 나누어 저장하는 디자인을 말하고, 가령 같은 주민 데이터를 처리하기 위해 스키마가 같은 '서현동 주민 테이블'과 '정자동 주민 테이블'을 사용을 뜻하며, 인덱스의 크기를 줄이고, 작업 동시성을 늘리기 위한 것이지만 보통 수평 분할을 한다고 했을 때는 하나의 데이터베이스 안에서 이루어지는 경우를 지칭한다.


## 장점

- 데이터베이스 샤딩은 수평적 확장을 용이하게 하는 데 도움이 될 수 있다. 수평적 확장은 부하를 분산시키고 더 많은 트래픽과 더 빠른 처리를 위해 기존 스택에 더 많은 시스템을 추가하는 방식이다.

- 쿼리 응답 시간을 단축
	- 데이터베이스에서 쿼리를 제출하면 원하는 결과를 찾기 전에 테이블의 모든 행을 검색해야 할 수도 있다. 대규모의 단일 데이터베이스가 있는 애플리케이션의 경우 쿼리가 엄청나게 느려질 수 있다. 그러나 한 테이블을 여러 개의 테이블로 분할하면 쿼리의 행 수가 줄어들고 결과 집합이 훨씬 빠르게 반환된다.

- 샤딩하지 않은 DB의 경우 문제가 되었을 때 DB 전체를 사용하지 못하는 경우가 발생할 수 있지만, 샤딩된 DB의 경우 전체를 사용하지 못하게되지는 않기 때문에 손상이 덜하다.


## 단점

- 구현이 어렵다.
	- 샤딩된 하나의 DB에 접근하는 것은 무리가 없으나 샤딩된 여러 DB를 방문해가며 결과를 조합하는 경우 샤딩된 DB들의 협력을 설정하기 어렵다.


- 샤드의 균형을 맞춰줘야한다.
	- 예를 들어, 두 개의 샤드를 가지고 있다고 가정해보면, 성이 하나는 A에서 M까지 시작하는 고객을 위한 것이고 다른 하나는 N에서 Z까지 시작하는 고객을 위한 것이다. 따라서 A-M샤드는 N-Z 샤드보다 더 많은 데이터가 점차 누적되어 애플리케이션의 속도가 느려지게 된다. 

- 샤딩이 모든 DB 엔진에서 기본적으로 지원되지 않는다.
