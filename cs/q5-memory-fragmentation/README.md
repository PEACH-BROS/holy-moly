# ë©”ëª¨ë¦¬ ë‹¨íŽ¸í™”ì— ëŒ€í•´ ì„¤ëª…í•˜ì„¸ìš”

[ë¹„ë°¥ì˜ ë©”ëª¨ë¦¬ ë‹¨íŽ¸í™”](bebop.md)

[ì—˜ë¦¬ì˜ ë©”ëª¨ë¦¬ ë‹¨íŽ¸í™”](elly-memory-fragmentation.md)

[ìŠ¤ë¦¬ë¦¬ì˜ ë©”ëª¨ë¦¬ ë‹¨íŽ¸í™”](stitch.md)



## ë©”ëª¨ë¦¬ ë‹¨íŽ¸í™” : *Memory Framentation*

ê¸°ì–µ ìž¥ì¹˜ì˜ ë¹ˆ ê³µê°„ ë˜ëŠ” ìžë£Œê°€ ì—¬ëŸ¬ ê°œì˜ ì¡°ê°ìœ¼ë¡œ ë‚˜ë‰˜ëŠ” í˜„ìƒì„ ë§í•œë‹¤. ì´ í˜„ìƒì€ ê¸°ì–µìž¥ì¹˜ì˜ ì‚¬ìš© ê°€ëŠ¥í•œ ê³µê°„ì„ ì¤„ì´ê±°ë‚˜, ì½ê¸°ì™€ ì“°ê¸°ì˜ ìˆ˜í–‰ì†ë„ë¥¼ ëŠ¦ì¶”ëŠ” ë¬¸ì œì ì„ ì•¼ê¸°í•œë‹¤ (ì‚¬ìš© ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬ê°€ ì¶©ë¶„ížˆ ì¡´ìž¬í•˜ì§€ë§Œ, í• ë‹¹(ì‚¬ìš©)ì´ ë¶ˆê°€ëŠ¥í•œ ìƒíƒœ)



- ì™¸ë¶€ ë‹¨íŽ¸í™” : *External Fragmentation*
- ë‚´ë¶€ ë‹¨íŽ¸í™” : *Internal Fragmentation*



## ì—°ì†ì  í• ë‹¹ : *Continuous Allocation*

ê¸°ì¡´ ë©”ëª¨ë¦¬ëŠ” **logical address**ê°€ ì—°ì†ì ì´ë©´ **physical address**ë„ ì—°ì†ì ìœ¼ë¡œ ë°°ì¹˜ëœë‹¤.

í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ë¬¼ë¦¬ì ì¸ ê³µê°„ì— ë°˜ìœ¼ë¡œ ìª¼ê°œì„œ ë°°ì¹˜í•  ìˆ˜ ì—†ê³  ì—°ì†ì ìœ¼ë¡œ ì´ì–´ì§€ê²Œ ë°°ì¹˜ë¥¼ í•´ì•¼í•œë‹¤ëŠ” ê²ƒ.

ì´ëŸ¬í•œ ì´ìœ ë¡œ External Fragmentationì´ ë°œìƒí•˜ê²Œ ë¨.

*cf) MMU*



## ì™¸ë¶€ ë‹¨íŽ¸í™” : *Exteranl Fragmentation*

ì „ì²´ ê³µê°„ì„ ê³„ì‚°í•´ë´¤ì„ ë•Œ ìš”ì²­ì„ ë§Œì¡±í• ë§Œí•œ ì¶©ë¶„í•œ ë©”ëª¨ë¦¬ê°€ ìžˆìŒì—ë„, ê°€ëŠ¥í•œ ê³µê°„ë“¤ì´ ì—°ì†ì ì´ì§€ ì•Šì„ ë•Œ. ì¦‰, ì €ìž¥ ê³µê°„ì´ ìž‘ì€ holeë“¤ë¡œ ì¡°ê°ì¡°ê° ë‚˜ìžˆì„ ë•Œ.

ì´ë•Œ, holeì€ íŠ¹ì • í”„ë¡œì„¸ìŠ¤ê°€ ìž‘ì—…ì„ ì¢…ë£Œí•˜ê³  ë©”ëª¨ë¦¬ë¥¼ ë°˜í™˜í•¨ìœ¼ë¡œ ìƒê¸°ëŠ” ë¹ˆ ê³µê°„ì„ ë§í•¨.

ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‚˜ì˜¨ ë°©ë²•ìœ¼ë¡œ `Compaction`ê³¼ `Paging`ì´ ì¡´ìž¬.

![image](https://user-images.githubusercontent.com/19922698/85363320-95513500-b55b-11ea-880d-ae47648892f5.png)



### ì••ì¶• : *Compaction*

ê¸°ì¡´ì˜ holeì„ ì œì™¸í•˜ê³  ë©”ëª¨ë¦¬ì— ì˜¬ë ¤ì ¸ ìžˆëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ì´ë™ì‹œì¼œ ê³µê°„ì„ í™•ë³´í•˜ëŠ” ë°©ë²•.

ì´ëŠ” ë‚¨ì•„ìžˆëŠ” holeì„ ì—°ì†ì ì¸ ê³µê°„ìœ¼ë¡œ ë§Œë“¤ì–´ ì¤„ ìˆ˜ ìžˆì–´ì„œ ì™¸ë¶€ ë‹¨íŽ¸í™” ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìžˆë‹¤.

ê·¸ëŸ¬ë‚˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ë©”ëª¨ë¦¬ê°€ ì•„ë‹Œ secondary storage*(ex. HDD)*ì— ìž„ì‹œë¡œ ë³µì‚¬í•˜ê³  ë‹¤ì‹œ ê°€ì ¸ì™€ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì‹¤í–‰ ì†ë„ê°€ ëŠë¦¬ë‹¤ëŠ” ë‹¨ì ì„ ê°€ì§€ê³  ìžˆìŒ.



### íŽ˜ì´ì§• : *Paging*

íŽ˜ì´ì§•ì€ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¼ì • í¬ê¸°ì¸ íŽ˜ì´ì§€(page)ë¡œ ìž˜ë¼ì„œ ë©”ëª¨ë¦¬ì— ì ìž¬í•˜ëŠ” ë°©ì‹ì„ ë§í•¨. 

ë¬¼ë¦¬ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš© í•  ë•Œ ê³ ì •ëœ í¬ê¸°ì˜ ë©”ëª¨ë¦¬ë¥¼ í”„ë ˆìž„ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ì–´ ì‚¬ìš©í•˜ë©´ì„œ ì—°ì†ë˜ì§€ ì•Šì€ ë©”ëª¨ë¦¬ë“¤ì´ ë°œìƒí•˜ì˜€ë‹¤.

ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ **ê°€ìƒ ë©”ëª¨ë¦¬** ê³„ì¸µì„ ë‘ê³   **ë§¤í•‘ í…Œì´ë¸”ì„ ì´ìš©**í•˜ì—¬ ì‹¤ì œë¡œ ë‹¨íŽ¸í™”ë˜ì–´ ìžˆëŠ”, **ì—°ì†ì ì´ì§€ ì•Šì€ ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©**í•¨ìœ¼ë¡œì¨  **ì™¸ë¶€ ë‹¨íŽ¸í™” ë¬¸ì œë¥¼ í•´ê²°**í•  ìˆ˜ ìžˆê²Œëœë‹¤.

logical addressë¥¼ ë™ì¼í•œ í¬ê¸°ë¡œ ìžë¥´ê³  physical addressë„ ë™ì¼í•œ í¬ê¸°ë¡œ ìž˜ë¼ì„œ mappingì„ ì‹œí‚¤ë©´ í”„ë¡œì„¸ìŠ¤ê°€ continuousí•˜ê²Œ ì €ìž¥ë˜ì§€ ì•Šì•„ë„ ë¨.

> ì´ë•Œ, Logical address spaceë¥¼ ë™ì¼í•œ í¬ê¸°ë¡œ ë‚˜ëˆˆ ê²ƒì„ íŽ˜ì´ì§€(*page*)ë¼ê³  í•˜ê³  Physical address spaceë¥¼ ë™ì¼í•œ í¬ê¸°ë¡œ ë‚˜ëˆˆ ê²ƒì„ í”„ë ˆìž„(*frame*)ë¼ê³  í•œë‹¤.

![image](https://user-images.githubusercontent.com/19922698/85364673-9d5ea400-b55e-11ea-9121-4abe528507a3.png)

#### ìž¥ì 

- Physical memoryì—ì„œ í• ë‹¹ê³¼ ë°˜í™˜ì´ ì‰½ë‹¤.
- ì™¸ë¶€ ë‹¨íŽ¸í™”ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.
- ì „ì²´ virtual address spaceê°€ ì „ì²´ physical address spaceë³´ë‹¤ ì»¤ë„ ìƒê´€ì—†ë‹¤.

#### ë‹¨ì 

- ë‚´ë¶€ ë‹¨íŽ¸í™”ê°€ ë°œìƒí•  ìˆ˜ ìžˆë‹¤.
  - **í•˜ì§€ë§Œ ì™¸ë¶€ ë‹¨íŽ¸í™”ë¡œ ë°œìƒí•˜ëŠ” ë©”ëª¨ë¦¬ ì†ì‹¤ì— ë¹„í•´ ë‚´ë¶€ ë‹¨íŽ¸í™”ë¡œ ë°œìƒí•˜ëŠ” ë©”ëª¨ë¦¬ ì†ì‹¤ì€ ë¯¸ë¹„í•˜ë‹¤.**
- ë©”ëª¨ë¦¬ ì°¸ì¡° ì˜¤ë²„í—¤ë“œê°€ ì¡´ìž¬í•œë‹¤.
  - íŽ˜ì´ì§€ í…Œì´ë¸”ê³¼ ë©”ëª¨ë¦¬ ê°ê°ì„ í™•ì¸í•´ì•¼ í•˜ë¯€ë¡œ 2ë²ˆì˜ ë©”ëª¨ë¦¬ ì°¸ì¡°ê°€ ë°œìƒí•œë‹¤.
  - ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ TLB(translation lookaside buffers)ë¥¼ ì‚¬ìš©í•œë‹¤.
- íŽ˜ì´ì§€ í…Œì´ë¸”ì— ì¶”ê°€ì ì¸ ê³µê°„ì„ í•„ìš”ë¡œ í•œë‹¤.
- íŽ˜ì´ì§€ ë‹¨ìœ„ë¥¼ ìž‘ê²Œ í•˜ë©´ ë‚´ë¶€ ë‹¨íŽ¸í™” ì—­ì‹œ í•´ê²°í•  ìˆ˜ ìžˆì§€ë§Œ, ê·¸ë§Œí¼ page mapping ê³¼ì •ì´ ì¦ê°€í•˜ê¸° ë•Œë¬¸ì— **trade off**ì´ë‹¤.





## ë‚´ë¶€ ë‹¨íŽ¸í™” : *Internal Fragmentation*

í”„ë¡œì„¸ìŠ¤ê°€ í•„ìš”í•œ ì–‘ë³´ë‹¤ ë” í° ë©”ëª¨ë¦¬ê°€ í• ë‹¹ë˜ì–´ì„œ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë©”ëª¨ë¦¬ ê³µê°„ì´ ë‚­ë¹„ ë˜ëŠ” ìƒí™©.

íŽ˜ì´ì§•ì„ ì˜ˆë¡œ ë“¤ì–´ë³´ë©´, í”„ë¡œì„¸ìŠ¤ì˜ í¬ê¸°ê°€ 6kbì´ê³  íŽ˜ì´ì§€ì˜ í¬ê¸°ê°€ 4kbì¼ ê²½ìš° í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ëŠ” 2ê°œì˜ íŽ˜ì´ì§€ë¥¼ í• ë‹¹ë°›ì•„ì•¼ í•œë‹¤. ì´ë•Œ í• ë‹¹ë°›ëŠ” ê³µê°„ì€ 8kbì´ì§€ë§Œ ì‹¤ì œ í”„ë¡œì„¸ìŠ¤ê°€ í•„ìš”ë¡œ í•˜ëŠ” ê³µê°„ì€ 6kbì´ë¯€ë¡œ 2kbì˜ ê³µê°„ì€ ì‚¬ìš©ë˜ì§€ ì•Šê³  ë‚­ë¹„ëœë‹¤. ì´ë¥¼ **ë‚´ë¶€ ë‹¨íŽ¸í™”**ë¼ê³  í•œë‹¤.

![image](https://user-images.githubusercontent.com/19922698/85363300-84082880-b55b-11ea-8bfc-5f8ef596cd3d.png)

![image](https://user-images.githubusercontent.com/13347548/85362158-b82e1a00-b558-11ea-812b-9d811006154f.png)



### ì„¸ê·¸ë©˜í…Œì´ì…˜ : Segmentation

ê°€ìƒë©”ëª¨ë¦¬ë¥¼ ì„œë¡œ *ë‹¤ë¥¸* í¬ê¸°ì˜ ì„¸ê·¸ë¨¼íŠ¸ë¡œ ë¶„í• í•´ì„œ ë©”ëª¨ë¦¬ í• ë‹¹ í›„, ì‹¤ì œ ë©”ëª¨ë¦¬ ì£¼ì†Œë¡œ ë³€í™˜

ê° ì„¸ê·¸ë¨¼íŠ¸ëŠ” ì—°ì†ì ì¸ ê³µê°„ì— ì €ìž¥ë˜ì–´ ìžˆìœ¼ë©°, ë§¤í•‘ì„ ìœ„í•´ segment tableì´ í•„ìš”í•˜ë‹¤.

ì„¸ê·¸ë¨¼íŠ¸ì˜ í¬ê¸°ê°€ ë‹¤ ë‹¤ë¥´ê¸° ë•Œë¬¸ì—, íŽ˜ì´ì§• ê¸°ë²•ì²˜ëŸ¼ ë©”ëª¨ë¦¬ë¥¼ ë¯¸ë¦¬ ë¶„í• í•´ ë‘˜ ìˆ˜ ì—†ê³ , ë©”ëª¨ë¦¬ê°€ ì ìž¬ë  ë•Œ ë¹ˆ ê³µê°„ì„ ì°¾ì•„ í• ë‹¹í•œë‹¤.

â“ì„¸ê·¸ë©˜í…Œì´ì…˜ ê¸°ë²•ì´ ì–´ë–»ê²Œ ë‚´ë¶€ ë‹¨íŽ¸í™”ë¥¼ í•´ê²°í•˜ì§€?

â—ï¸ë©”ëª¨ë¦¬ëŠ” byte ë‹¨ìœ„ê°€ ì•„ë‹ˆë¼ ì‹œìŠ¤í…œ block ë‹¨ìœ„ë¡œ í• ë‹¹ë˜ê³ , blockì˜ í¬ê¸°ëŠ” ì‹œìŠ¤í…œë§ˆë‹¤ ë‹¤ë¥´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, 1 block = 1 KBì¸ ì‹œìŠ¤í…œì´ ìžˆë‹¤. í”„ë¡œì„¸ìŠ¤ê°€ 14.3KBë¥¼ ìš”ì²­í•˜ë©´ ì‹œìŠ¤í…œì€ ë¸”ë¡ ë‹¨ìœ„ë¡œ 15KBë§Œí¼ í• ë‹¹í•´ì¤€ë‹¤. ì´ë ‡ê²Œ ë˜ë©´ 0.7KBì˜ ë©”ëª¨ë¦¬ ë‚­ë¹„ê°€ ì¼ì–´ë‚˜ê²Œ ëœë‹¤.

ì„¸ê·¸ë©˜íŠ¸ í…Œì´ë¸”ì€ ì„¸ê·¸ë¨¼íŠ¸ë“¤ì˜ ì •ë³´ê°€ ë‹´ê²¨ìžˆëŠ”ë°, ì„¸ê·¸ë¨¼íŠ¸ì˜ ì‹œìž‘ì£¼ì†Œ(base), ì„¸ê·¸ë¨¼íŠ¸ì˜ í¬ê¸°(=í”„ë¡œì„¸ìŠ¤ê°€ í•„ìš”í•œ ë©”ëª¨ë¦¬ ê³µê°„)(limit)ë¥¼ ê°€ì§€ê³  ìžˆë‹¤.

![image](https://user-images.githubusercontent.com/13347548/85366894-34c5f600-b563-11ea-90cd-7f9f05b7b392.png)

#### ðŸš¨ í•˜ì§€ë§Œ ì™¸ë¶€ ë‹¨íŽ¸í™” ë¬¸ì œê°€ ì‹¬ê°í•˜ê¸° ë•Œë¬¸ì— íŽ˜ì´ì§•ì„ ì“°ëŠ”ê²Œ ë” ì¢‹ë‹¤.



> ### **ë©”ëª¨ë¦¬ êµ¬ì¡°**
>
> ![image](https://user-images.githubusercontent.com/19922698/85486815-57f5b180-b606-11ea-8e58-b2de22ff0e73.png)

Primary Memory : ìš°ë¦¬ê°€ ì“°ëŠ” RAM

Secondary Storage : HDD, ì™¸ìž¥í•˜ë“œ, CD ë“±

